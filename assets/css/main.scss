/* ========================================================================
   JAPANESE DESIGN SYSTEM - PERFORMANCE OPTIMIZED
   ======================================================================== */

/* =============================================================================
   PART 1: STRATEGIC FONT LOADING - å­—é«”ç­–ç•¥å„ªåŒ–
   ============================================================================= */

/* 1. æ ¸å¿ƒå­—é«” - åªè¼‰å…¥å¿…è¦å­—é‡ */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Shippori+Mincho+B1:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap');

/* 2. è‹±æ–‡è£é£¾å­—é«” - ç²¾é¸è¼‰å…¥ */
@import url('https://fonts.googleapis.com/css2?family=Marcellus:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Tenor+Sans:wght@400;600&display=swap');
@import url('https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital,wght@0,400;1,400&display=swap');

/* 3. ç¨‹å¼ç¢¼å­—é«” */
@import url('https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap');

/* 4. å‚³çµ±ä¸­æ–‡å­—é«” - å»¶é²è¼‰å…¥ */
@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+Traditional+Chinese:wght@400;500;600&display=swap');

/* Minimal Mistakes æ•´åˆ */
@import "minimal-mistakes/skins/{{ site.minimal_mistakes_skin | default: 'default' }}";
@import "minimal-mistakes";

/* =============================================================================
   PART 2: æ—¥æœ¬è‰²å½©ç³»çµ± - å®Œæ•´èªæ„åŒ–è¨­è¨ˆ
   ============================================================================= */

:root {
  /* å­—é«”å±¤ç´šç³»çµ± - ä¿æŒä½ çš„åŸå§‹æ¦‚å¿µä½†çµæ§‹åŒ– */
  --font-primary-tc: 'Noto Sans TC', 'PingFang TC', 'Microsoft JhengHei', sans-serif;
  --font-secondary-tc: 'Shippori Mincho B1', 'Noto Serif Traditional Chinese', serif;
  --font-interface: 'Zen Maru Gothic', system-ui, sans-serif;
  
  /* è‹±æ–‡å­—é«” - ç¶­æŒä½ çš„å…¸é›…é¢¨æ ¼ */
  --font-title-en: 'Marcellus', 'Times New Roman', serif;
  --font-body-en: 'Tenor Sans', 'Helvetica Neue', sans-serif;
  --font-quote-en: 'DM Serif Text', Georgia, serif;
  --font-code: 'Fira Mono', 'SF Mono', Consolas, monospace;
  
  /* é–±è®€å­—é«”åˆ‡æ›ç³»çµ± - ä¿æŒä½ çš„æ¦‚å¿µ */
  --reading-font-serif: var(--font-secondary-tc);
  --reading-font-sans: var(--font-primary-tc);
  --reading-font-main: var(--reading-font-serif); /* é è¨­ä½¿ç”¨è¥¯ç·šé«” */

  /* æ—¥æœ¬å‚³çµ±è‰²å½© - ç¶­æŒä½ çš„ç¾å­¸ä½†å¢å¼·å°æ¯”åº¦ */
  /* æ—¥é–“æ¨¡å¼ (æº«æŸ”æ—¥æœ¬è‰²ç¥¨) */
  --sakura: #ffadd6;           /* æ«»èŠ±è‰² - ä¸»è‰²èª¿ */
  --toki: #f5b2b2;            /* é´‡è‰² - æ¬¡è¦è‰² */
  --yamabuki: #f8b500;         /* å±±å¹è‰² - å¼·èª¿è‰² */
  --nando: #2f5d62;           /* ç´æˆ¸è‰² - ä¸»æ–‡å­— */
  --ainezumi: #566c73;         /* è—é¼  - æ¬¡è¦æ–‡å­— */
  --ruri: #1e50a2;            /* ç‘ ç’ƒè‰² - é€£çµ */
  --sango: #f17c67;           /* çŠç‘šè‰² - æ‡¸åœ */
  --wakatake: #68be8d;         /* è‹¥ç«¹è‰² - æˆåŠŸ */
  --moegi: #93b881;           /* èŒé»„ - æŒ‰éˆ•æ‡¸åœ */
  --matcha: #c5c56a;          /* æŠ¹èŒ¶è‰² - æ¨™ç±¤ */
  
  /* ä¸­æ€§è‰²å½© - å¢å¼·å¯ç”¨æ€§ */
  --shiro: #ffffff;           /* ç™½ - èƒŒæ™¯ */
  --usuzumi: #f8fafb;         /* è–„å¢¨ - æ¬¡è¦èƒŒæ™¯ */
  --ginmouse: #e8f4f8;        /* éŠ€é¼  - æ·¡èƒŒæ™¯ */
  --mizuiro: #b8d4e3;         /* æ°´è‰² - é‚Šæ¡† */

  /* å¤œé–“æ¨¡å¼ (æ·±é‚ƒå¤œè‰²) */
  --yoru-murasaki: #4a4458;    /* å¤œç´« - ä¸»è‰²èª¿ */
  --kon: #5c4a72;             /* ç´º - æ¬¡è¦è‰² */
  --kogane: #d4af37;          /* é»ƒé‡‘ - å¼·èª¿è‰² */
  --zoge: #e8e3d3;            /* è±¡ç‰™ - ä¸»æ–‡å­— */
  --haizakura: #c8c3b8;       /* ç°æ«» - æ¬¡è¦æ–‡å­— */
  --asagi: #9bb8d3;           /* æ·ºè”¥ - é€£çµ */
  --beni: #e8a87c;            /* ç´… - æ‡¸åœ */
  --kuro: #1a1a1a;            /* é»‘ - èƒŒæ™¯ */
  --sumizumi: #2d2d2d;        /* ç‚­ - æ¬¡è¦èƒŒæ™¯ */
  --hai: #262626;             /* ç° - æ·¡èƒŒæ™¯ */
  --tetsu: #404040;           /* éµ - é‚Šæ¡† */

  /* èªæ„åŒ–è‰²å½©æ˜ å°„ - æ—¥é–“æ¨¡å¼ */
  --color-primary: var(--sakura);
  --color-secondary: var(--toki);
  --color-accent: var(--yamabuki);
  --color-text: var(--nando);
  --color-text-muted: var(--ainezumi);
  --color-link: var(--ruri);
  --color-link-hover: var(--sango);
  --color-success: var(--wakatake);
  --color-warning: var(--yamabuki);
  --color-tag: var(--matcha);
  
  /* èƒŒæ™¯è‰²ç³»çµ± */
  --color-bg: var(--shiro);
  --color-bg-elevated: var(--usuzumi);
  --color-bg-muted: var(--ginmouse);
  --color-border: var(--mizuiro);
  --color-surface: var(--color-bg);
  
  /* ç¨‹å¼ç¢¼è‰²å½© - æ—¥é–“ */
  --color-code-bg: #f8f9fa;
  --color-code-text: #2d3748;
  --color-code-border: #e2e8f0;
  --color-inline-code-bg: #edf2f7;
  --color-inline-code-text: #c53030;
  
  /* é–“è·ç³»çµ± - 8px åŸºæº– */
  --space-xs: 0.25rem;    /* 4px */
  --space-sm: 0.5rem;     /* 8px */
  --space-md: 1rem;       /* 16px */
  --space-lg: 1.5rem;     /* 24px */
  --space-xl: 2rem;       /* 32px */
  --space-2xl: 3rem;      /* 48px */
  
  /* åœ“è§’ç³»çµ± */
  --radius-sm: 0.25rem;   /* 4px */
  --radius-md: 0.5rem;    /* 8px */
  --radius-lg: 0.75rem;   /* 12px */
  --radius-xl: 1rem;      /* 16px */
  --radius-pill: 50px;
  
  /* é™°å½±ç³»çµ± */
  --shadow-subtle: 0 1px 3px rgba(0, 0, 0, 0.05);
  --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.08);
  --shadow-medium: 0 4px 15px rgba(0, 0, 0, 0.12);
  --shadow-strong: 0 8px 32px rgba(0, 0, 0, 0.15);
  
  /* å‹•ç•«æ™‚é–“ */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --duration-slow: 350ms;
}

/* å¤œé–“æ¨¡å¼åˆ‡æ› */
[data-theme="dark"] {
  --color-primary: var(--yoru-murasaki);
  --color-secondary: var(--kon);
  --color-accent: var(--kogane);
  --color-text: var(--zoge);
  --color-text-muted: var(--haizakura);
  --color-link: var(--asagi);
  --color-link-hover: var(--beni);
  --color-success: #6b8e7f;
  --color-warning: var(--kogane);
  --color-tag: #8b956d;
  
  --color-bg: var(--kuro);
  --color-bg-elevated: var(--sumizumi);
  --color-bg-muted: var(--hai);
  --color-border: var(--tetsu);
  --color-surface: var(--sumizumi);
  
  /* ç¨‹å¼ç¢¼è‰²å½© - å¤œé–“ */
  --color-code-bg: #1a202c;
  --color-code-text: #e2e8f0;
  --color-code-border: #2d3748;
  --color-inline-code-bg: #2d3748;
  --color-inline-code-text: #fc8181;
  
  color-scheme: dark;
}

/* =============================================================================
   PART 3: åŸºç¤è¨­å®š - æ•ˆèƒ½èˆ‡å¯è¨ªå•æ€§å„ªå…ˆ
   ============================================================================= */

/* ç¾ä»£ CSS Reset */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* å°Šé‡ä½¿ç”¨è€…çš„å‹•ä½œåå¥½ */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
  
  * {
    transition: 
      background-color var(--duration-normal) ease,
      color var(--duration-normal) ease,
      border-color var(--duration-normal) ease,
      box-shadow var(--duration-normal) ease,
      transform var(--duration-fast) ease;
  }
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

html {
  font-size: 100%;
  text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* =============================================================================
   PART 4: ä¸»é«”å­—é«”è¨­å®š - ä¿æŒä½ çš„é¢¨æ ¼ç†å¿µ
   ============================================================================= */

body {
  font-family: var(--font-body-en), var(--reading-font-main);
  font-size: 1rem;
  font-weight: 400;
  line-height: 1.7; /* ç¨å¾®æ”¾é¬†è¡Œè· */
  letter-spacing: 0.02em;
  background-color: var(--color-bg);
  color: var(--color-text);
  font-feature-settings: "kern" 1, "liga" 1;
}

/* =============================================================================
   PART 5: æ¨™é¡Œå±¤ç´š - ç¶­æŒä½ çš„ç²—é«”+ç·Šå¯†ç†å¿µä½†æ”¹å–„å¯è®€æ€§
   ============================================================================= */

h1, h2, h3, h4, h5, h6,
.page__title, 
.page__hero-title, 
.site-title {
  font-family: var(--font-title-en), var(--font-interface), var(--font-secondary-tc);
  color: var(--color-text);
  font-weight: 700;
  letter-spacing: -0.02em;
  line-height: 1.2;
  margin-top: 0;
  margin-bottom: var(--space-md);
}

h1 { 
  font-size: 2.25rem; /* 36px - æ›´å¤§æ¨™é¡Œ */
  font-weight: 800;
  letter-spacing: -0.03em;
  margin-bottom: var(--space-lg);
}

h2 { 
  font-size: 1.875rem; /* 30px */
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-top: var(--space-xl);
  margin-bottom: var(--space-md);
}

h3 { 
  font-size: 1.5rem; /* 24px */
  font-weight: 600;
  letter-spacing: -0.01em;
  margin-top: var(--space-lg);
}

h4 { 
  font-size: 1.25rem; /* 20px */
  font-weight: 600;
}

h5 { 
  font-size: 1.125rem; /* 18px */
  font-weight: 500;
}

h6 { 
  font-size: 1rem; /* 16px */
  font-weight: 500;
}

/* =============================================================================
   PART 6: æ—¥å¤œåˆ‡æ›æŒ‰éˆ• - ä¿æŒä½ çš„è¨­è¨ˆä½†å¢å¼·äº’å‹•
   ============================================================================= */

.theme-toggle {
  position: fixed;
  top: var(--space-lg);
  right: var(--space-lg);
  z-index: 1000;
  background: var(--color-surface);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-pill);
  padding: var(--space-sm) var(--space-md);
  cursor: pointer;
  font-family: var(--font-interface);
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--color-text);
  box-shadow: var(--shadow-medium);
  backdrop-filter: blur(10px);
  transition: all var(--duration-normal) ease;
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.theme-toggle:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-strong);
  border-color: var(--color-accent);
}

.theme-toggle::before {
  content: "ğŸŒ¸";
  font-size: 1rem;
}

[data-theme="dark"] .theme-toggle::before {
  content: "ğŸŒ™";
}

/* =============================================================================
   PART 7: å°èˆªç³»çµ± - ä¿æŒæ¼¸å±¤ç¾å­¸ä½†å¢å¼·å¯ç”¨æ€§
   ============================================================================= */

.masthead {
  background: linear-gradient(135deg, 
    var(--color-primary) 0%, 
    var(--color-secondary) 50%, 
    var(--color-bg-elevated) 100%);
  border-bottom: 1px solid var(--color-border);
  box-shadow: var(--shadow-soft);
  position: sticky;
  top: 0;
  z-index: 999;
  backdrop-filter: blur(10px);
}

.site-title {
  font-family: var(--font-title-en);
  font-weight: 700;
  font-size: 1.5rem;
  color: var(--color-text);
  text-decoration: none;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  letter-spacing: -0.01em;
  transition: all var(--duration-normal) ease;
}

.site-title:hover {
  transform: scale(1.02);
  text-shadow: 2px 2px 8px hsla(from var(--color-primary) h s l / 0.4);
  color: var(--color-text);
}

.greedy-nav a {
  color: var(--color-text);
  font-size: 0.9rem;
  font-family: var(--font-interface);
  font-weight: 500;
  letter-spacing: -0.005em;
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-md);
  transition: all var(--duration-fast) ease;
}

.greedy-nav a:hover {
  color: var(--color-link);
  background-color: hsla(from var(--color-bg-muted) h s l / 0.8);
}

/* =============================================================================
   PART 8: é é¢æ¨™é¡Œ - ä¿æŒä¸­å¤®å°é½Šå’Œè£é£¾ä½†æ”¹å–„å±¤ç´š
   ============================================================================= */

.page__title {
  font-family: var(--font-title-en);
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-text);
  text-align: center;
  position: relative;
  padding-bottom: var(--space-md);
  margin-bottom: var(--space-xl);
  border-bottom: 3px solid var(--color-accent);
  letter-spacing: -0.02em;
  line-height: 1.1;
}

/* å¯é¸çš„è£é£¾å…ƒç´  - ä¿æŒä½ çš„ç¾å­¸æ¦‚å¿µ */
.page__title--decorated::before,
.page__title--decorated::after {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
  opacity: 0.7;
}

.page__title--decorated::before {
  content: "ğŸŒ¸";
  left: -3rem;
}

.page__title--decorated::after {
  content: "ğŸŒ¸";
  right: -3rem;
}

[data-theme="dark"] .page__title--decorated::before,
[data-theme="dark"] .page__title--decorated::after {
  content: "ğŸŒ™";
}

/* =============================================================================
   PART 9: é€£çµç³»çµ± - ç²¾ç·»çš„æ‡¸åœæ•ˆæœ
   ============================================================================= */

a {
  color: var(--color-link);
  text-decoration: none;
  text-decoration-color: transparent;
  text-decoration-thickness: 2px;
  text-underline-offset: 2px;
  transition: all var(--duration-fast) ease;
}

a:hover {
  color: var(--color-link-hover);
  text-decoration-color: currentColor;
}

a:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
  border-radius: var(--radius-sm);
}

/* =============================================================================
   PART 10: æŒ‰éˆ•ç³»çµ± - ä¿æŒæ¼¸å±¤ç¾å­¸
   ============================================================================= */

.btn {
  background: linear-gradient(135deg, 
    var(--color-success) 0%, 
    var(--color-primary) 100%);
  color: var(--color-bg);
  border: none;
  border-radius: var(--radius-pill);
  padding: var(--space-sm) var(--space-lg);
  font-family: var(--font-interface);
  font-weight: 600;
  font-size: 0.875rem;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  box-shadow: var(--shadow-medium);
  cursor: pointer;
  transition: all var(--duration-normal) ease;
}

.btn:hover {
  color: var(--color-bg);
  transform: translateY(-2px);
  box-shadow: var(--shadow-strong);
}

.btn:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

/* =============================================================================
   PART 11: æ–‡ç« å¡ç‰‡ - ä¿æŒç·Šå¯†å¸ƒå±€ä½†æ”¹å–„é–“è·
   ============================================================================= */

.archive__item {
  background: var(--color-surface);
  border-left: 6px solid var(--color-tag);
  border-radius: var(--radius-lg);
  padding: var(--space-md) var(--space-lg);
  margin-bottom: var(--space-md);
  box-shadow: var(--shadow-soft);
  position: relative;
  overflow: hidden;
  transition: all var(--duration-normal) ease;
}

.archive__item:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-medium);
  border-left-color: var(--color-accent);
}

.archive__item-title {
  margin-bottom: var(--space-sm);
  line-height: 1.3;
}

.archive__item-title a {
  font-family: var(--font-interface);
  font-size: 1.125rem;
  font-weight: 600;
  line-height: 1.3;
  color: var(--color-text);
}

.archive__item-excerpt {
  margin-bottom: var(--space-sm);
  font-size: 0.875rem;
  line-height: 1.6;
  color: var(--color-text-muted);
}

.archive__item .page__meta {
  margin-bottom: 0;
  font-size: 0.75rem;
  color: var(--color-text-muted);
  font-family: var(--font-interface);
}

/* =============================================================================
   PART 12: å´é‚Šæ¬„ - ä¿æŒæ¼¸å±¤èƒŒæ™¯å’Œå›ºå®šå®šä½
   ============================================================================= */

.sidebar {
  background: linear-gradient(135deg, 
    var(--color-bg-elevated) 0%, 
    hsla(from var(--color-border) h s l / 0.3) 100%);
  padding: var(--space-lg);
  border-radius: var(--radius-xl);
  border: 1px solid var(--color-border);
  backdrop-filter: blur(10px);
  position: sticky;
  top: var(--space-lg);
  max-height: calc(100vh - var(--space-2xl));
  overflow-y: auto;
  box-shadow: var(--shadow-medium);
  scrollbar-width: thin;
  scrollbar-color: var(--color-border) transparent;
}

.sidebar::-webkit-scrollbar {
  width: 4px;
}

.sidebar::-webkit-scrollbar-track {
  background: transparent;
}

.sidebar::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: var(--radius-sm);
}

.author__avatar {
  margin-bottom: var(--space-md);
}

.author__avatar img {
  border: 4px solid var(--color-accent);
  box-shadow: var(--shadow-medium);
  border-radius: 50%;
}

.author__bio {
  margin-bottom: var(--space-md);
  font-size: 0.875rem;
  line-height: 1.6;
  color: var(--color-text-muted);
}

.author__urls {
  margin-bottom: var(--space-md);
}

.author__urls li {
  margin-bottom: var(--space-xs);
}

/* =============================================================================
   PART 13: æ¨™ç±¤ç³»çµ± - ä¿æŒæ¼¸å±¤å’Œå¤§å¯«é¢¨æ ¼
   ============================================================================= */

.page__taxonomy-item {
  background: linear-gradient(135deg, 
    var(--color-tag) 0%, 
    var(--color-accent) 100%);
  color: var(--color-bg);
  border-radius: var(--radius-pill);
  padding: var(--space-xs) var(--space-md);
  font-family: var(--font-interface);
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  box-shadow: var(--shadow-soft);
  transition: all var(--duration-normal) ease;
  display: inline-block;
  margin: var(--space-xs);
}

.page__taxonomy-item:hover {
  background: linear-gradient(135deg, 
    var(--color-success) 0%, 
    var(--color-primary) 100%);
  transform: scale(1.05);
  box-shadow: var(--shadow-medium);
  color: var(--color-bg);
}

/* =============================================================================
   PART 14: å¼•ç”¨æ–‡å­— - ä¿æŒè©©æ„é¢¨æ ¼ä½†æ”¹å–„å¯è®€æ€§
   ============================================================================= */

blockquote {
  border-left: 4px solid var(--color-link-hover);
  background: linear-gradient(135deg, 
    var(--color-bg-elevated), 
    hsla(from var(--color-border) h s l / 0.3));
  color: var(--color-text);
  padding: var(--space-md) var(--space-lg);
  margin: var(--space-lg) 0;
  border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
  font-family: var(--font-quote-en), var(--reading-font-main);
  font-size: 0.95rem;
  line-height: 1.6;
  font-style: italic;
  font-weight: 400;
  position: relative;
  box-shadow: var(--shadow-soft);
}

blockquote::before {
  content: "ğŸ’­";
  position: absolute;
  left: -15px;
  top: -10px;
  font-size: 1rem;
  background: var(--color-bg);
  padding: var(--space-xs);
  border-radius: 50%;
  box-shadow: var(--shadow-soft);
}

[data-theme="dark"] blockquote::before {
  content: "ğŸŒŒ";
  background: var(--color-bg);
}

/* =============================================================================
   PART 15: ç¨‹å¼ç¢¼å€å¡Š - ç¢ºä¿å…©ç¨®ä¸»é¡Œä¸‹çš„å¯è¦‹æ€§
   ============================================================================= */

.highlight,
pre {
  background: var(--color-code-bg);
  border: 1px solid var(--color-code-border);
  border-left: 6px solid var(--color-link);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  margin: var(--space-lg) 0;
  box-shadow: var(--shadow-soft);
  overflow-x: auto;
  position: relative;
}

.highlight code,
pre code {
  font-family: var(--font-code);
  font-size: 0.875rem;
  line-height: 1.6;
  color: var(--color-code-text);
  background: transparent;
  padding: 0;
  border-radius: 0;
  display: block;
  white-space: pre;
  word-wrap: normal;
}

/* è¡Œå…§ç¨‹å¼ç¢¼ */
code {
  font-family: var(--font-code);
  font-size: 0.875rem;
  background: var(--color-inline-code-bg);
  color: var(--color-inline-code-text);
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  border: 1px solid var(--color-border);
  font-weight: 500;
}

/* ç¢ºä¿ç¨‹å¼ç¢¼å€å¡Šå…§çš„ code ä¸è¢«è¡Œå…§æ¨£å¼å½±éŸ¿ */
.highlight code,
pre code {
  background: transparent;
  border: none;
  color: var(--color-code-text);
  padding: 0;
}

/* ç¨‹å¼ç¢¼å€å¡Šæ»¾å‹•æ¢ */
.highlight::-webkit-scrollbar {
  height: 8px;
}

.highlight::-webkit-scrollbar-track {
  background: var(--color-bg-muted);
  border-radius: var(--radius-sm);
}

.highlight::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: var(--radius-sm);
}

.highlight::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

/* =============================================================================
   PART 16: æ–‡ç« å…§å®¹å€åŸŸ - ä¿æŒç·Šå¯†ä½†å¯è®€çš„å¸ƒå±€
   ============================================================================= */

.page__content {
  background: var(--color-bg);
  color: var(--color-text);
  padding: var(--space-xl) var(--space-2xl);
  border-radius: var(--radius-lg);
  font-family: var(--font-body-en), var(--reading-font-main);
  font-size: 1rem;
  line-height: 1.7;
  max-width: none;
}

/* ç‚ºå³å´ç›®éŒ„ç•™å‡ºç©ºé–“ - ä¿æŒä½ çš„å¸ƒå±€æ¦‚å¿µ */
@media (min-width: 1024px) {
  .page__content {
    margin-right: 320px; /* ç‚ºTOCé ç•™ç©ºé–“ */
  }
}

/* æ®µè½æ¨£å¼ - ä¿æŒä½ çš„ç·Šå¯†é–“è·ç†å¿µä½†ç¨å¾®èª¿æ•´ */
.page__content p {
  margin-bottom: 1.2em; /* ç¨å¾®å¢åŠ æ®µè½é–“è· */
  text-align: justify;
  color: var(--color-text);
  max-width: 65ch; /* æœ€ä½³é–±è®€å¯¬åº¦ */
}

/* æ¨™é¡Œé–“è·èª¿æ•´ - ä¿æŒå±¤ç´šæ„Ÿ */
.page__content h1,
.page__content h2,
.page__content h3,
.page__content h4,
.page__content h5,
.page__content h6 {
  margin-top: 1.5em;
  margin-bottom: 0.8em;
  color: var(--color-text);
}

.page__content h2 {
  margin-top: 2em; /* h2 éœ€è¦æ›´å¤šä¸Šæ–¹ç©ºé–“ */
}

/* åˆ—è¡¨æ¨£å¼ - æ”¹å–„å¯è®€æ€§ */
.page__content ul,
.page__content ol {
  margin-bottom: 1em;
  padding-left: 1.5em;
}

.page__content li {
  margin-bottom: 0.25em;
  line-height: 1.6;
}

/* é¦–å­—æ”¾å¤§æ•ˆæœ - ä¿æŒä½ çš„å…¸é›…é¢¨æ ¼ */
.page__content > p:first-of-type::first-letter {
  font-size: 3em;
  font-family: var(--font-title-en);
  font-weight: 400;
  float: left;
  line-height: 0.8;
  margin: 0.1em 0.15em 0 0;
  color: var(--color-accent);
  text-shadow: 2px 2px 4px hsla(from var(--color-accent) h s l / 0.3);
}

/* =============================================================================
   PART 17: å³å´ç›®éŒ„ - ä¿æŒå›ºå®šå®šä½å’Œå„ªé›…æ¨£å¼
   ============================================================================= */

.toc {
  position: fixed;
  right: var(--space-lg);
  top: 120px;
  width: 240px;
  max-height: calc(100vh - 150px);
  overflow-y: auto;
  z-index: 999;
  background: var(--color-surface);
  backdrop-filter: blur(10px);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-strong);
  scrollbar-width: thin;
  scrollbar-color: var(--color-border) transparent;
}

.toc::-webkit-scrollbar {
  width: 4px;
}

.toc::-webkit-scrollbar-track {
  background: transparent;
}

.toc::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: var(--radius-sm);
}

.toc::-webkit-scrollbar-thumb:hover {
  background: var(--color-tag);
}

/* ç›®éŒ„æ¨™é¡Œ - ä¿æŒä½ çš„è¨­è¨ˆç†å¿µ */
.toc .nav__title {
  background: var(--color-tag);
  color: var(--color-text);
  font-family: var(--font-interface);
  font-weight: 600;
  font-size: 0.875rem;
  padding: var(--space-md);
  margin: 0;
  border-radius: var(--radius-xl) var(--radius-xl) 0 0;
  text-align: center;
  letter-spacing: 0.02em;
}

/* å¯é¸çš„åœ–æ¨™ - ä¿æŒä½ çš„è£é£¾ç†å¿µ */
.toc .nav__title--with-icon::before {
  content: "ğŸ“– ";
  margin-right: var(--space-xs);
}

/* ç›®éŒ„åˆ—è¡¨æ¨£å¼ */
.toc nav ul {
  margin: 0;
  padding: var(--space-md);
  list-style: none;
}

.toc nav li {
  margin-bottom: var(--space-sm);
  line-height: 1.2;
}

.toc nav a {
  color: var(--color-text);
  text-decoration: none;
  font-size: 0.8rem; /* ç¨å¾®å¤§ä¸€é»æé«˜å¯è®€æ€§ */
  font-family: var(--font-body-en), var(--reading-font-sans);
  font-weight: 400;
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  display: block;
  transition: all var(--duration-fast) ease;
  border-left: 3px solid transparent;
}

.toc nav a:hover {
  background: var(--color-bg-muted);
  color: var(--color-link);
  border-left-color: var(--color-accent);
  transform: translateX(3px);
}

/* ç›®éŒ„å±¤ç´šç¸®æ’ - ä¿æŒä½ çš„å±¤ç´šç³»çµ± */
.toc nav ul ul {
  padding-left: var(--space-lg);
}

.toc nav ul ul a {
  font-size: 0.75rem;
  color: var(--color-text-muted);
}

.toc nav ul ul ul {
  padding-left: var(--space-xl);
}

.toc nav ul ul ul a {
  font-size: 0.7rem;
  opacity: 0.8;
}

/* ç•¶å‰é–±è®€ä½ç½®é«˜äº® */
.toc nav a.active {
  background: var(--color-accent);
  color: var(--color-bg);
  border-left-color: var(--color-link);
  font-weight: 600;
}

/* ç§»é™¤å´é‚Šæ¬„ä¸­çš„ç›®éŒ„ä»¥é¿å…é‡è¤‡ */
.sidebar .toc {
  display: none;
}

/* ç›®éŒ„åˆ‡æ›æŒ‰éˆ• - ä¿æŒä½ çš„åœ“å½¢è¨­è¨ˆ */
.toc-toggle {
  position: fixed;
  right: var(--space-lg);
  top: 80px;
  z-index: 1001;
  background: var(--color-surface);
  border: 2px solid var(--color-border);
  border-radius: 50%;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 1.1rem;
  box-shadow: var(--shadow-medium);
  backdrop-filter: blur(10px);
  transition: all var(--duration-normal) ease;
}

.toc-toggle::before {
  content: "ğŸ“‹";
}

[data-theme="dark"] .toc-toggle::before {
  content: "ğŸ“„";
}

.toc-toggle:hover {
  transform: scale(1.1);
  box-shadow: var(--shadow-strong);
  border-color: var(--color-accent);
}

/* ç›®éŒ„éš±è—ç‹€æ…‹ */
.toc.hidden {
  transform: translateX(100%);
  opacity: 0;
  pointer-events: none;
}

/* =============================================================================
   PART 18: è¼¸å…¥æ¡†ç³»çµ± - ä¿æŒä¸€è‡´çš„è¨­è¨ˆèªè¨€
   ============================================================================= */

input[type="search"], 
input[type="text"], 
input[type="email"] {
  background: var(--color-bg);
  border: 2px solid var(--color-border);
  color: var(--color-text);
  border-radius: var(--radius-md);
  padding: var(--space-sm) var(--space-md);
  font-family: var(--font-interface);
  font-size: 0.875rem;
  transition: all var(--duration-fast) ease;
}

input[type="search"]:focus, 
input[type="text"]:focus, 
input[type="email"]:focus {
  border-color: var(--color-link);
  outline: none;
  box-shadow: 0 0 0 3px hsla(from var(--color-link) h s l / 0.1);
}

/* =============================================================================
   PART 19: é è…³ - ä¿æŒæ¼¸å±¤è¨­è¨ˆ
   ============================================================================= */

.page__footer {
  background: linear-gradient(135deg, 
    var(--color-text-muted) 0%, 
    var(--color-text) 100%);
  color: var(--color-bg);
  margin-top: var(--space-2xl);
  padding: var(--space-2xl) 0;
}

.page__footer a {
  color: var(--color-bg-elevated);
  transition: color var(--duration-fast) ease;
}

.page__footer a:hover {
  color: var(--color-bg);
}

/* =============================================================================
   PART 20: éŸ¿æ‡‰å¼è¨­è¨ˆ - ä¿æŒä½ çš„æ–·é»é‚è¼¯
   ============================================================================= */

/* å¹³æ¿ä½ˆå±€ */
@media (max-width: 1200px) {
  .toc {
    width: 220px;
  }
  
  .page__content {
    margin-right: 250px;
  }
  
  .theme-toggle {
    top: var(--space-md);
    right: var(--space-md);
  }
}

/* æ‰‹æ©Ÿä½ˆå±€ */
@media (max-width: 768px) {
  :root {
    --space-md: 0.75rem;
    --space-lg: 1rem;
    --space-xl: 1.25rem;
    --space-2xl: 1.5rem;
  }

  .toc,
  .toc-toggle {
    display: none;
  }
  
  .page__content {
    margin-right: 0;
    padding: var(--space-md);
  }
  
  .theme-toggle {
    top: var(--space-sm);
    right: var(--space-sm);
    padding: var(--space-xs) var(--space-sm);
    font-size: 0.75rem;
  }
  
  .masthead {
    padding: var(--space-sm) 0;
  }
  
  h1 {
    font-size: 1.75rem;
  }
  
  h2 {
    font-size: 1.5rem;
  }
  
  .page__title {
    font-size: 1.75rem;
    margin-bottom: var(--space-lg);
  }
  
  .archive__item {
    padding: var(--space-md);
  }
  
  .sidebar {
    padding: var(--space-md);
  }
  
  /* ç§»é™¤é¦–å­—æ”¾å¤§æ•ˆæœåœ¨å°è¢å¹•ä¸Š */
  .page__content > p:first-of-type::first-letter {
    font-size: inherit;
    float: none;
    margin: 0;
    color: inherit;
    text-shadow: none;
  }
}

/* å°æ‰‹æ©Ÿä½ˆå±€ */
@media (max-width: 480px) {
  .page__content {
    padding: var(--space-sm);
  }
  
  .archive__item {
    padding: var(--space-sm) var(--space-md);
  }
  
  .sidebar {
    padding: var(--space-sm);
  }
  
  .theme-toggle {
    padding: var(--space-xs);
    font-size: 0.7rem;
  }
  
  h1 {
    font-size: 1.5rem;
  }
  
  .page__title {
    font-size: 1.5rem;
  }
  
  /* ç§»é™¤è£é£¾å…ƒç´ åœ¨æ¥µå°è¢å¹• */
  .page__title--decorated::before,
  .page__title--decorated::after {
    display: none;
  }
}

/* =============================================================================
   PART 21: å¯è¨ªå•æ€§å¢å¼· - å°Šé‡ä½¿ç”¨è€…åå¥½
   ============================================================================= */

/* é«˜å°æ¯”æ¨¡å¼æ”¯æ´ */
@media (prefers-contrast: high) {
  :root {
    --color-border: var(--color-text);
    --color-bg-muted: var(--color-bg);
  }
  
  [data-theme="dark"] {
    --color-border: var(--color-text);
    --color-bg-muted: var(--color-bg);
  }
  
  .btn,
  .page__taxonomy-item {
    border: 2px solid currentColor;
  }
  
  .archive__item {
    border: 1px solid var(--color-border);
  }
}

/* è¢å¹•é–±è®€å™¨å°ˆç”¨å…§å®¹ */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* è·³èºé€£çµ */
.skip-link {
  position: absolute;
  top: -40px;
  left: var(--space-sm);
  background: var(--color-text);
  color: var(--color-bg);
  padding: var(--space-sm) var(--space-md);
  text-decoration: none;
  border-radius: var(--radius-md);
  z-index: 1100;
  font-weight: 600;
  transition: top var(--duration-fast) ease;
}

.skip-link:focus {
  top: var(--space-sm);
}

/* ç„¦é»æŒ‡ç¤ºå™¨ */
.focus-ring:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
  border-radius: var(--radius-sm);
}

/* =============================================================================
   PART 22: æ•ˆèƒ½å„ªåŒ– - ç¾ä»£ CSS æŠ€è¡“
   ============================================================================= */

/* GPU åŠ é€Ÿé—œéµå…ƒç´  */
.theme-toggle,
.btn,
.archive__item,
.toc-toggle {
  will-change: transform;
  transform: translateZ(0);
}

/* å­—é«”æ¸²æŸ“å„ªåŒ– */
.page__content {
  font-variant-numeric: oldstyle-nums;
  font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
  text-rendering: optimizeLegibility;
}

/* å®¹å™¨æŸ¥è©¢ (æ¼¸é€²å¢å¼·) */
@container (min-width: 600px) {
  .archive__item {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: var(--space-md);
    align-items: start;
  }
  
  .archive__item-title {
    grid-column: 1;
  }
  
  .page__meta {
    grid-column: 2;
    grid-row: 1;
    text-align: right;
    white-space: nowrap;
  }
  
  .archive__item-excerpt {
    grid-column: 1 / -1;
  }
}

/* =============================================================================
   PART 23: JavaScript æ•´åˆé¡åˆ¥ - ç‚ºäº’å‹•åšæº–å‚™
   ============================================================================= */

/* è¼‰å…¥ç‹€æ…‹ */
.is-loading {
  pointer-events: none;
  opacity: 0.6;
  cursor: wait;
}

/* é¡¯ç¤º/éš±è—ç‹€æ…‹ */
.is-hidden {
  display: none !important;
}

.is-visible {
  display: block !important;
}

/* TOC æ´»å‹•ç‹€æ…‹ */
.toc-item.is-active {
  font-weight: 600;
  color: var(--color-accent);
}

.toc-item.is-visible {
  opacity: 1;
}

.toc-item.is-hidden {
  opacity: 0.5;
}

/* æ¼¸é€²é¡¯ç¤ºå‹•ç•« */
.js .reveal {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity var(--duration-slow) ease, transform var(--duration-slow) ease;
}

.js .reveal.is-revealed {
  opacity: 1;
  transform: translateY(0);
}

/* é–±è®€é€²åº¦æŒ‡ç¤ºå™¨ */
.reading-progress {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: var(--color-bg-muted);
  z-index: 1100;
}

.reading-progress__bar {
  height: 100%;
  background: linear-gradient(90deg, var(--color-accent), var(--color-primary));
  width: 0%;
  transition: width var(--duration-fast) ease;
}

/* =============================================================================
   PART 24: åˆ—å°æ¨£å¼ - ä¿æŒå…§å®¹å®Œæ•´æ€§
   ============================================================================= */

@media print {
  .theme-toggle,
  .toc-toggle,
  .toc,
  .masthead,
  .page__footer,
  .sidebar,
  .reading-progress {
    display: none !important;
  }
  
  body {
    font-size: 12pt;
    line-height: 1.4;
    color: #000;
    background: #fff;
  }
  
  .page__content {
    margin: 0;
    padding: 0;
    box-shadow: none;
    border-radius: 0;
    max-width: none;
  }
  
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    page-break-inside: avoid;
  }
  
  blockquote,
  .highlight {
    page-break-inside: avoid;
  }
  
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
  }
}

/* =============================================================================
   PART 25: å¯¦é©—æ€§åŠŸèƒ½ - æ¼¸é€²å¢å¼·
   ============================================================================= */

/* CSS æ»¾å‹•æ•æ‰ */
@supports (scroll-snap-type: y mandatory) {
  .article-list {
    scroll-snap-type: y proximity;
  }
  
  .archive__item {
    scroll-snap-align: start;
  }
}

/* ç¾ä»£é¸å–æ¨£å¼ */
::selection {
  background: hsla(from var(--color-accent) h s l / 0.3);
  color: var(--color-text);
}

::-moz-selection {
  background: hsla(from var(--color-accent) h s l / 0.3);
  color: var(--color-text);
}

/* æ·±è‰²æ¨¡å¼åœ–ç‰‡èª¿æ•´ */
[data-theme="dark"] img {
  opacity: 0.9;
  transition: opacity var(--duration-normal) ease;
}

[data-theme="dark"] img:hover {
  opacity: 1;
}

/* =============================================================================
   PART 26: é™¤éŒ¯å·¥å…· (ç”Ÿç”¢ç’°å¢ƒè«‹ç§»é™¤)
   ============================================================================= */

/* è§£é™¤è¨»è§£ä»¥é€²è¡Œä½ˆå±€é™¤éŒ¯ */
/*
.debug * {
  outline: 1px solid red !important;
}

.debug .toc {
  outline: 2px solid blue !important;
}

.debug .sidebar {
  outline: 2px solid green !important;
}

.debug .page__content {
  outline: 2px solid purple !important;
}
*/

/* stylelint-enable */